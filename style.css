/* === SEBAR FOTO DI PINGGIR === */
const cards = document.querySelectorAll(".gallery.scattered .card");
const gallery = document.getElementById("gallery");

function scatterCards() {
  const galleryHeight = gallery.clientHeight;
  const galleryWidth = gallery.clientWidth;

  cards.forEach((card, i) => {
    let top, left;
    const side = i % 4; // posisi pinggir

    if (side === 0) {
      top = 30;
      left = Math.random() * (galleryWidth - 280);
    } else if (side === 1) {
      top = Math.random() * (galleryHeight - 240);
      left = galleryWidth - 300;
    } else if (side === 2) {
      top = galleryHeight - 260;
      left = Math.random() * (galleryWidth - 280);
    } else {
      top = Math.random() * (galleryHeight - 240);
      left = 30;
    }

    const rotate = (Math.random() * 12 - 6) + "deg";
    card.style.top = `${top}px`;
    card.style.left = `${left}px`;
    card.style.setProperty("--rotate", rotate);

    setTimeout(() => {
      card.classList.add("show");
      typeWriter(card.querySelector(".caption")); // caption animasi
    }, i * 500);
  });
}

window.addEventListener("load", scatterCards);
window.addEventListener("resize", scatterCards);

/* === TOGGLE MODE SIANG/MALAM === */
const toggleBtn = document.getElementById("toggleMode");
toggleBtn.addEventListener("click", () => {
  document.body.classList.toggle("day");
  toggleBtn.textContent = document.body.classList.contains("day") ? "‚òÄÔ∏è" : "üåô";
});

/* === TYPEWRITER ANIMASI CAPTION === */
function typeWriter(element) {
  const text = element.getAttribute("data-text");
  let i = 0;
  element.textContent = "";

  function typing() {
    if (i < text.length) {
      element.textContent += text.charAt(i);
      i++;
      setTimeout(typing, 80); // kecepatan ketik
    }
  }
  typing();
}

/* === BACKGROUND BINTANG KELAP-KELIP === */
const canvas = document.getElementById("stars");
const ctx = canvas.getContext("2d");
let stars = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

function createStars(count) {
  stars = [];
  for (let i = 0; i < count; i++) {
    stars.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      radius: Math.random() * 1.5,
      alpha: Math.random(),
      speed: Math.random() * 0.02 + 0.005
    });
  }
}

function animateStars() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  stars.forEach(star => {
    star.alpha += star.speed;
    if (star.alpha > 1) {
      star.alpha = 0;
      star.x = Math.random() * canvas.width;
      star.y = Math.random() * canvas.height;
    }
    ctx.beginPath();
    ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
    ctx.fillStyle = `rgba(255,255,255,${star.alpha})`;
    ctx.fill();
  });
  requestAnimationFrame(animateStars);
}

createStars(120);
animateStars();
